{% extends 'base.html' %}

{% block title %}Music Services - Harmoniq{% endblock %}

{% block content %}
<div class="space-y-6">
    <!-- Header -->
    <div>
        <h1 class="text-2xl font-bold text-gray-900">Music Services</h1>
        <p class="text-gray-600">Connect your music streaming accounts to import playlists and tracks</p>
    </div>

    <!-- Connected Services -->
    <div class="bg-white rounded-lg shadow-sm border border-gray-200">
        <div class="p-6 border-b border-gray-200">
            <h2 class="text-lg font-medium text-gray-900">Connected Services</h2>
        </div>
        
        <div class="p-6">
            {% if services %}
                <div class="space-y-4">
                    {% for service in services %}
                        <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                            <div class="flex items-center">
                                <div class="w-10 h-10 rounded-lg flex items-center justify-center mr-4
                                    {% if service.service == 'spotify' %}bg-green-500{% elif service.service == 'tidal' %}bg-blue-500{% else %}bg-gray-500{% endif %}">
                                    {% if service.service == 'spotify' %}
                                        <svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 24 24">
                                            <path d="M12 0C5.4 0 0 5.4 0 12s5.4 12 12 12 12-5.4 12-12S18.66 0 12 0zm5.521 17.34c-.24.359-.66.48-1.021.24-2.82-1.74-6.36-2.101-10.561-1.141-.418.122-.779-.179-.899-.539-.12-.421.18-.78.54-.9 4.56-1.021 8.52-.6 11.64 1.32.42.18.479.659.301 1.02zm1.44-3.3c-.301.42-.841.6-1.262.3-3.239-1.98-8.159-2.58-11.939-1.38-.479.12-1.02-.12-1.14-.6-.12-.48.12-1.021.6-1.141C9.6 9.9 15 10.561 18.72 12.84c.361.181.54.78.241 1.2zm.12-3.36C15.24 8.4 8.82 8.16 5.16 9.301c-.6.179-1.2-.181-1.38-.721-.18-.601.18-1.2.72-1.381 4.26-1.26 11.28-1.02 15.721 1.621.539.3.719 1.02.419 1.56-.299.421-1.02.599-1.559.3z"/>
                                        </svg>
                                    {% elif service.service == 'tidal' %}
                                        <svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 24 24">
                                            <path d="M12.012 2.25c-5.385 0-9.763 4.377-9.763 9.762s4.378 9.762 9.763 9.762c5.385 0 9.762-4.377 9.762-9.762S17.397 2.25 12.012 2.25zM9.463 16.812V7.188L15.787 12l-6.324 4.812z"/>
                                        </svg>
                                    {% else %}
                                        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"></path>
                                        </svg>
                                    {% endif %}
                                </div>
                                <div>
                                    <h3 class="font-medium text-gray-900">{{ service.get_service_display }}</h3>
                                    <p class="text-sm text-gray-500">Connected as {{ service.external_user_id }}</p>
                                </div>
                            </div>
                            <button onclick="disconnectService('{{ service.id }}')" 
                                    class="text-red-600 hover:text-red-800 text-sm font-medium">
                                Disconnect
                            </button>
                        </div>
                    {% endfor %}
                </div>
            {% else %}
                <div class="text-center py-8">
                    <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"></path>
                    </svg>
                    <h3 class="mt-2 text-sm font-medium text-gray-900">No services connected</h3>
                    <p class="mt-1 text-sm text-gray-500">Connect your music streaming accounts to get started.</p>
                </div>
            {% endif %}
        </div>
    </div>

    <!-- Available Services -->
    <div class="bg-white rounded-lg shadow-sm border border-gray-200">
        <div class="p-6 border-b border-gray-200">
            <h2 class="text-lg font-medium text-gray-900">Available Services</h2>
        </div>
        
        <div class="p-6">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <!-- Spotify -->
                <div class="border border-gray-200 rounded-lg p-6 hover:border-gray-300 transition-colors">
                    <div class="flex items-center mb-4">
                        <div class="w-12 h-12 bg-green-500 rounded-lg flex items-center justify-center mr-4">
                            <svg class="w-8 h-8 text-white" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12 0C5.4 0 0 5.4 0 12s5.4 12 12 12 12-5.4 12-12S18.66 0 12 0zm5.521 17.34c-.24.359-.66.48-1.021.24-2.82-1.74-6.36-2.101-10.561-1.141-.418.122-.779-.179-.899-.539-.12-.421.18-.78.54-.9 4.56-1.021 8.52-.6 11.64 1.32.42.18.479.659.301 1.02zm1.44-3.3c-.301.42-.841.6-1.262.3-3.239-1.98-8.159-2.58-11.939-1.38-.479.12-1.02-.12-1.14-.6-.12-.48.12-1.021.6-1.141C9.6 9.9 15 10.561 18.72 12.84c.361.181.54.78.241 1.2zm.12-3.36C15.24 8.4 8.82 8.16 5.16 9.301c-.6.179-1.2-.181-1.38-.721-.18-.601.18-1.2.72-1.381 4.26-1.26 11.28-1.02 15.721 1.621.539.3.719 1.02.419 1.56-.299.421-1.02.599-1.559.3z"/>
                            </svg>
                        </div>
                        <div>
                            <h3 class="text-lg font-medium text-gray-900">Spotify</h3>
                            <p class="text-sm text-gray-500">Connect your Spotify account</p>
                        </div>
                    </div>
                    
                    <p class="text-sm text-gray-600 mb-4">
                        Import your Spotify playlists and tracks to manage them in Harmoniq.
                    </p>
                    
                    <button onclick="connectSpotify()" 
                            class="w-full btn-macos btn-macos-primary">
                        Connect Spotify
                    </button>
                </div>

                <!-- Tidal -->
                <div class="border border-gray-200 rounded-lg p-6 hover:border-gray-300 transition-colors">
                    <div class="flex items-center mb-4">
                        <div class="w-12 h-12 bg-blue-500 rounded-lg flex items-center justify-center mr-4">
                            <svg class="w-8 h-8 text-white" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12.012 2.25c-5.385 0-9.763 4.377-9.763 9.762s4.378 9.762 9.763 9.762c5.385 0 9.762-4.377 9.762-9.762S17.397 2.25 12.012 2.25zM9.463 16.812V7.188L15.787 12l-6.324 4.812z"/>
                            </svg>
                        </div>
                        <div>
                            <h3 class="text-lg font-medium text-gray-900">Tidal</h3>
                            <p class="text-sm text-gray-500">Connect your Tidal account</p>
                        </div>
                    </div>
                    
                    <p class="text-sm text-gray-600 mb-4">
                        Import your Tidal playlists and tracks to manage them in Harmoniq.
                    </p>
                    
                    <button onclick="connectTidal()" 
                            class="w-full btn-macos btn-macos-primary">
                        Connect Tidal
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Import Options -->
    {% if services %}
        <div class="bg-white rounded-lg shadow-sm border border-gray-200">
            <div class="p-6 border-b border-gray-200">
                <h2 class="text-lg font-medium text-gray-900">Import Options</h2>
            </div>
            
            <div class="p-6">
                <div class="space-y-4">
                    <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                        <div>
                            <h3 class="font-medium text-gray-900">Import Playlists</h3>
                            <p class="text-sm text-gray-500">Import all playlists from your connected services</p>
                        </div>
                        <button onclick="importPlaylists()" 
                                class="btn-macos btn-macos-secondary">
                            Import
                        </button>
                    </div>
                    
                    <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                        <div>
                            <h3 class="font-medium text-gray-900">Sync Library</h3>
                            <p class="text-sm text-gray-500">Keep your Harmoniq library in sync with your music services</p>
                        </div>
                        <button onclick="syncLibrary()" 
                                class="btn-macos btn-macos-secondary">
                            Sync
                        </button>
                    </div>
                </div>
            </div>
        </div>
    {% endif %}
</div>

<!-- CSRF Token for AJAX requests -->
{% csrf_token %}
{% endblock %}

{% block extra_js %}
<script>
    function connectSpotify() {
        // This would redirect to Spotify OAuth
        alert('Spotify OAuth integration would be implemented here');
    }
    
    function connectTidal() {
        // This would redirect to Tidal OAuth
        alert('Tidal OAuth integration would be implemented here');
    }
    
    function disconnectService(serviceId) {
        if (confirm('Are you sure you want to disconnect this service?')) {
            // This would call an API to disconnect the service
            alert('Service disconnection would be implemented here');
        }
    }
    
    function importPlaylists() {
        // This would call an API to import playlists
        alert('Playlist import would be implemented here');
    }
    
    function syncLibrary() {
        // This would call an API to sync the library
        alert('Library sync would be implemented here');
    }
</script>
{% endblock %}